{"remainingRequest":"C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\ts-loader\\index.js??ref--13-3!C:\\Users\\Luca\\Companion\\CoreApp\\shared\\libs\\ow-window.ts","dependencies":[{"path":"C:\\Users\\Luca\\Companion\\CoreApp\\shared\\libs\\ow-window.ts","mtime":1608681494462},{"path":"C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1608685446369},{"path":"C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1608685447511},{"path":"C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\babel-loader\\lib\\index.js","mtime":1608685524005},{"path":"C:\\Users\\Luca\\Companion\\CoreApp\\background\\node_modules\\ts-loader\\index.js","mtime":1608685447723}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJDOlxcVXNlcnNcXEx1Y2FcXENvbXBhbmlvblxcQ29yZUFwcFxcYmFja2dyb3VuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXFVzZXJzXFxMdWNhXFxDb21wYW5pb25cXENvcmVBcHBcXGJhY2tncm91bmRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcVXNlcnNcXEx1Y2FcXENvbXBhbmlvblxcQ29yZUFwcFxcYmFja2dyb3VuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwovLyBAdHMtbm9jaGVjawpleHBvcnQgdmFyIE9XV2luZG93ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gT1dXaW5kb3coKSB7CiAgICB2YXIgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgT1dXaW5kb3cpOwoKICAgIHRoaXMuX25hbWUgPSBuYW1lOwogICAgdGhpcy5faWQgPSBudWxsOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE9XV2luZG93LCBbewogICAga2V5OiAicmVzdG9yZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Jlc3RvcmUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgdGhhdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbmV3IFByb21pc2UoCiAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkOwogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuYXNzdXJlT2J0YWluZWQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSB0aGF0Ll9pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJ3b2xmLndpbmRvd3MucmVzdG9yZShpZCwgZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSBjb25zb2xlLmVycm9yKCJbcmVzdG9yZV0gLSBhbiBlcnJvciBvY2N1cnJlZCwgd2luZG93SWQ9Ii5jb25jYXQoaWQsICIsIHJlYXNvbj0iKS5jb25jYXQocmVzdWx0LmVycm9yKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcmVzdG9yZSgpIHsKICAgICAgICByZXR1cm4gX3Jlc3RvcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3RvcmU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJtaW5pbWl6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX21pbmltaXplID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIHRoYXQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIG5ldyBQcm9taXNlKAogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkOwogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5hc3N1cmVPYnRhaW5lZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IHRoYXQuX2lkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcndvbGYud2luZG93cy5taW5pbWl6ZShpZCwgZnVuY3Rpb24gKCkge30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc29sdmUoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gbWluaW1pemUoKSB7CiAgICAgICAgcmV0dXJuIF9taW5pbWl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gbWluaW1pemU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJtYXhpbWl6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX21heGltaXplID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHRoYXQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIG5ldyBQcm9taXNlKAogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkOwogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5hc3N1cmVPYnRhaW5lZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IHRoYXQuX2lkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcndvbGYud2luZG93cy5tYXhpbWl6ZShpZCwgZnVuY3Rpb24gKCkge30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHJlc29sdmUoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNSk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWYzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gbWF4aW1pemUoKSB7CiAgICAgICAgcmV0dXJuIF9tYXhpbWl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gbWF4aW1pemU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJoaWRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGlkZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciB0aGF0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpczsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZSgKICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9yZWY0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBpZDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuYXNzdXJlT2J0YWluZWQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSB0aGF0Ll9pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJ3b2xmLndpbmRvd3MuaGlkZShpZCwgZnVuY3Rpb24gKCkge30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIHJlc29sdmUoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgICByZXR1cm4gX2hpZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhpZGU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJjbG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2Nsb3NlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgIHZhciB0aGF0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIG5ldyBQcm9taXNlKAogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB2YXIgX3JlZjUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOShyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCByZXN1bHQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGF0LmFzc3VyZU9idGFpbmVkKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gdGhhdC5faWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0V2luZG93U3RhdGUoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ5LnNlbnQ7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzdWx0LnN1Y2Nlc3MgJiYgcmVzdWx0LndpbmRvd19zdGF0ZSAhPT0gJ2Nsb3NlZCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmludGVybmFsQ2xvc2UoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIHJlc29sdmUoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTkpOwogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSgpKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gY2xvc2UoKSB7CiAgICAgICAgcmV0dXJuIF9jbG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gY2xvc2U7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJkcmFnTW92ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZHJhZ01vdmUoZWxlbSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGVsZW0ub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBvdmVyd29sZi53aW5kb3dzLmRyYWdNb3ZlKF90aGlzMi5fbmFtZSk7CiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0V2luZG93U3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRXaW5kb3dTdGF0ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICB2YXIgdGhhdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZSgKICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9yZWY2ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKHJlc29sdmUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaWQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuYXNzdXJlT2J0YWluZWQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSB0aGF0Ll9pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJ3b2xmLndpbmRvd3MuZ2V0V2luZG93U3RhdGUoaWQsIHJlc29sdmUpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g2KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRXaW5kb3dTdGF0ZSgpIHsKICAgICAgICByZXR1cm4gX2dldFdpbmRvd1N0YXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRXaW5kb3dTdGF0ZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIm9idGFpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2J0YWluKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIGNiID0gZnVuY3Rpb24gY2IocmVzKSB7CiAgICAgICAgICBpZiAocmVzICYmIHJlcy5zdGF0dXMgPT09ICJzdWNjZXNzIiAmJiByZXMud2luZG93ICYmIHJlcy53aW5kb3cuaWQpIHsKICAgICAgICAgICAgX3RoaXMzLl9pZCA9IHJlcy53aW5kb3cuaWQ7CgogICAgICAgICAgICBpZiAoIV90aGlzMy5fbmFtZSkgewogICAgICAgICAgICAgIF90aGlzMy5fbmFtZSA9IHJlcy53aW5kb3cubmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzb2x2ZShyZXMud2luZG93KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMy5faWQgPSBudWxsOwogICAgICAgICAgICByZWplY3QoKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoIV90aGlzMy5fbmFtZSkgewogICAgICAgICAgb3ZlcndvbGYud2luZG93cy5nZXRDdXJyZW50V2luZG93KGNiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3ZlcndvbGYud2luZG93cy5vYnRhaW5EZWNsYXJlZFdpbmRvdyhfdGhpczMuX25hbWUsIGNiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImFzc3VyZU9idGFpbmVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfYXNzdXJlT2J0YWluZWQgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTQoKSB7CiAgICAgICAgdmFyIHRoYXQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNCQoX2NvbnRleHQxNCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpczsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LmFicnVwdCgicmV0dXJuIiwgbmV3IFByb21pc2UoCiAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmNyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMyhyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQub2J0YWluKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgcmVzb2x2ZSgpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTMpOwogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94NykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmNy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSgpKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gYXNzdXJlT2J0YWluZWQoKSB7CiAgICAgICAgcmV0dXJuIF9hc3N1cmVPYnRhaW5lZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYXNzdXJlT2J0YWluZWQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJpbnRlcm5hbENsb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaW50ZXJuYWxDbG9zZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNigpIHsKICAgICAgICB2YXIgdGhhdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE2JChfY29udGV4dDE2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTYucHJldiA9IF9jb250ZXh0MTYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZSgKICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9yZWY4ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE1KHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgICAgIHZhciBpZDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE1JChfY29udGV4dDE1KSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5hc3N1cmVPYnRhaW5lZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IHRoYXQuX2lkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcndvbGYud2luZG93cy5jbG9zZShpZCwgZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzICYmIHJlcy5zdWNjZXNzKSByZXNvbHZlKCk7ZWxzZSByZWplY3QocmVzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNSk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g4LCBfeDkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSkpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxNiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGludGVybmFsQ2xvc2UoKSB7CiAgICAgICAgcmV0dXJuIF9pbnRlcm5hbENsb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpbnRlcm5hbENsb3NlOwogICAgfSgpCiAgfV0sIFt7CiAgICBrZXk6ICJnZXRDdXJyZW50SW5mbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEN1cnJlbnRJbmZvID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE4KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTgkKF9jb250ZXh0MTgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxOC5wcmV2ID0gX2NvbnRleHQxOC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTguYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZSgKICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9yZWY5ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE3KHJlc29sdmUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE3JChfY29udGV4dDE3KSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTcucHJldiA9IF9jb250ZXh0MTcubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJ3b2xmLndpbmRvd3MuZ2V0Q3VycmVudFdpbmRvdyhmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LndpbmRvdyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTcpOwogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MTApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSkpOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxOCk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRJbmZvKCkgewogICAgICAgIHJldHVybiBfZ2V0Q3VycmVudEluZm8uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEN1cnJlbnRJbmZvOwogICAgfSgpCiAgfV0pOwoKICByZXR1cm4gT1dXaW5kb3c7Cn0oKTs="},{"version":3,"sources":["C:\\Users\\Luca\\Companion\\CoreApp\\shared\\libs\\ow-window.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-nocheck\r\n\r\ntype GetWindowStateResult = overwolf.windows.GetWindowStateResult;\r\nexport class OWWindow {\r\n  private _name: string | null;\r\n  private _id: string | null;\r\n\r\n  constructor(name: string | null = null) {\r\n    this._name = name;\r\n    this._id = null;\r\n  }\r\n\r\n  public async restore(): Promise<void> {\r\n    let that = this;\r\n\r\n    return new Promise<void>(async (resolve) => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n      overwolf.windows.restore(id, result => {\r\n        if (!result.success)\r\n          console.error(`[restore] - an error occurred, windowId=${id}, reason=${result.error}`);\r\n        resolve();\r\n      });\r\n    })\r\n  }\r\n\r\n  public async minimize(): Promise<void> {\r\n    let that = this;\r\n\r\n    return new Promise<void>(async resolve => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n      overwolf.windows.minimize(id, () => { });\r\n      return resolve();\r\n    })\r\n  }\r\n\r\n  public async maximize(): Promise<void> {\r\n    let that = this;\r\n\r\n    return new Promise<void>(async resolve => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n      overwolf.windows.maximize(id, () => { });\r\n      return resolve();\r\n    })\r\n  }\r\n\r\n  public async hide(): Promise<void> {\r\n    let that = this;\r\n\r\n    return new Promise<void>(async resolve => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n      overwolf.windows.hide(id, () => { });\r\n      return resolve();\r\n    })\r\n  }\r\n\r\n  public async close() {\r\n    let that = this;\r\n\r\n    return new Promise(async resolve => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n\r\n      const result = await this.getWindowState();\r\n\r\n      if (result.success &&\r\n        (result.window_state !== 'closed')) {\r\n        await this.internalClose();\r\n      }\r\n\r\n      return resolve();\r\n    })\r\n  }\r\n\r\n  public dragMove(elem: HTMLElement) {\r\n    elem.onmousedown = e => {\r\n      e.preventDefault();\r\n      overwolf.windows.dragMove(this._name);\r\n    };\r\n  }\r\n\r\n  public async getWindowState(): Promise<GetWindowStateResult> {\r\n    let that = this;\r\n\r\n    return new Promise<GetWindowStateResult>(async resolve => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n      overwolf.windows.getWindowState(id, resolve);\r\n    })\r\n  }\r\n\r\n  public static async getCurrentInfo(): Promise<overwolf.windows.WindowInfo> {\r\n    return new Promise<overwolf.windows.WindowInfo>(async resolve => {\r\n      overwolf.windows.getCurrentWindow(result => {\r\n        resolve(result.window);\r\n      })\r\n    })\r\n  }\r\n\r\n  private obtain(): Promise<overwolf.windows.WindowInfo | null> {\r\n    return new Promise((resolve, reject) => {\r\n      const cb = res => {\r\n        if (res && res.status === \"success\" && res.window && res.window.id) {\r\n          this._id = res.window.id;\r\n\r\n          if (!this._name) {\r\n            this._name = res.window.name;\r\n          }\r\n\r\n          resolve(res.window);\r\n        } else {\r\n          this._id = null;\r\n          reject();\r\n        }\r\n      };\r\n\r\n      if (!this._name) {\r\n        overwolf.windows.getCurrentWindow(cb);\r\n      } else {\r\n        overwolf.windows.obtainDeclaredWindow(this._name, cb);\r\n      }\r\n    })\r\n  }\r\n\r\n  private async assureObtained(): Promise<void> {\r\n    let that = this;\r\n    return new Promise<void>(async resolve => {\r\n      await that.obtain();\r\n      return resolve();\r\n    });\r\n  }\r\n\r\n  private async internalClose(): Promise<void> {\r\n    let that = this;\r\n\r\n    return new Promise<void>(async (resolve, reject) => {\r\n      await that.assureObtained();\r\n      let id: string = <string>that._id;\r\n\r\n      overwolf.windows.close(id, (res: any) => {\r\n\r\n        if (res && res.success)\r\n          resolve();\r\n        else\r\n          reject(res);\r\n      });\r\n    })\r\n  }\r\n}\r\n"],"sourceRoot":""}]}